#为什么使用消息队列
* 解耦：通过一个 MQ，Pub/Sub 发布订阅消息这么一个模型，A 系统就跟其它系统彻底解耦了
* 异步：前端操作，耗时操作使用MQ，增加体验
* 削峰：使用 MQ，每秒 5k 个请求写入 MQ，A 系统每秒钟最多处理 2k 个请求，因为 MySQL 每秒钟最多处理 2k 个。A 系统从 MQ 中慢慢拉取请求，每秒钟就拉取 2k 个请求，不要超过自己每秒能处理的最大请求数量就 ok，
#消息队列问题
##高可用
* 略
##可靠性
###消息一致性
* 略
###消息幂等
* 消息幂等由业务放控制
* 数据要写库，你先根据主键查一下，如果有就update。
* 写 Redis，那没问题了，反正每次都是 set，天然幂等性。
* 需要让生产者发送每条数据的时候，里面加一个全局唯一的 id，然后你这里消费到了之后，先根据这个 id 去比如 Redis 里查一下，之前消费过吗？如果没有消费过，你就处理，然后这个 id 写 Redis。
* 数据库的唯一键来保证重复数据不会重复插入多条。
###顺序消费
* 略
#选型
* 中小型软件公司，建议选RabbitMQ.
   * 自带管理界面用起来十分方便。
   * RabbitMQ的社区十分活跃，可以解决开发过程中遇到的bug。
   * 自带功能比功能比kafka较完备
* 大型软件公司，根据具体使用在rocketMq和kafka之间二选一
   * 分布式架构，消息零丢失，但功能简单
   * 至于kafka，根据业务场景选择，如果有日志采集，大数据分析功能，肯定是首选kafka了
   * kafka只能支持单消费者单线程顺序顺序消费
* 如果有顺序消费的需求考虑RocketMQ。 
